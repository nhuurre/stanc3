  $ ../../../../../../../install/default/bin/stanc --auto-format corr-lda.stan
data {
  int<lower=2> K;
  // num topics
  int<lower=2> V;
  // num words
  int<lower=1> M;
  // num docs
  int<lower=1> N;
  // total word instances
  int<lower=1, upper=V> w[N];
  // word n
  int<lower=1, upper=M> doc[N];
  // doc ID for word n
  vector<lower=0>[V] beta;
  // word prior
}
parameters {
  vector[K] mu;
  // topic mean
  corr_matrix[K] Omega;
  // correlation matrix
  vector<lower=0>[K] sigma;
  // scales
  vector[K] eta[M];
  // logit topic dist for doc m
  simplex[V] phi[K];
  // word dist for topic k
}
transformed parameters {
  simplex[K] theta[M];
  // simplex topic dist for doc m
  cov_matrix[K] Sigma;
  // covariance matrix
  for (m in 1 : M) 
    theta[m] <- softmax(eta[m]);
  for (m in 1 : K) {
    Sigma[m, m] <- sigma[m] * sigma[m] * Omega[m, m];
    for (n in (m + 1) : K) {
      Sigma[m, n] <- sigma[m] * sigma[n] * Omega[m, n];
      Sigma[n, m] <- Sigma[m, n];
    }
  }
}
model {
  // priors
  for (k in 1 : K) 
    phi[k] ~ dirichlet(beta);
  mu ~ normal(0, 5);
  Omega ~ lkj_corr(2.0);
  sigma ~ cauchy(0, 5);
  // topic distribution for docs
  for (m in 1 : M) 
    eta[m] ~ multi_normal(mu, Sigma);
  // token probabilities
  for (n in 1 : N) {
    real gamma[K];
    for (k in 1 : K) 
      gamma[k] <- log(theta[doc[n], k]) + log(phi[k, w[n]]);
    increment_log_prob(log_sum_exp(gamma));
    // likelihood
  }
}


Warning: deprecated language construct used in 'corr-lda.stan', line 21, column 14:
   -------------------------------------------------
    19:    cov_matrix[K] Sigma;       // covariance matrix
    20:    for (m in 1:M)
    21:      theta[m] <- softmax(eta[m]);
                       ^
    22:    for (m in 1:K) {
    23:      Sigma[m,m] <- sigma[m] * sigma[m] * Omega[m,m];
   -------------------------------------------------

assignment operator <- is deprecated in the Stan language; use = instead.


Warning: deprecated language construct used in 'corr-lda.stan', line 23, column 16:
   -------------------------------------------------
    21:      theta[m] <- softmax(eta[m]);
    22:    for (m in 1:K) {
    23:      Sigma[m,m] <- sigma[m] * sigma[m] * Omega[m,m];
                         ^
    24:      for (n in (m+1):K) {
    25:        Sigma[m,n] <- sigma[m] * sigma[n] * Omega[m,n];
   -------------------------------------------------

assignment operator <- is deprecated in the Stan language; use = instead.


Warning: deprecated language construct used in 'corr-lda.stan', line 25, column 18:
   -------------------------------------------------
    23:      Sigma[m,m] <- sigma[m] * sigma[m] * Omega[m,m];
    24:      for (n in (m+1):K) {
    25:        Sigma[m,n] <- sigma[m] * sigma[n] * Omega[m,n];
                           ^
    26:        Sigma[n,m] <- Sigma[m,n];
    27:      }
   -------------------------------------------------

assignment operator <- is deprecated in the Stan language; use = instead.


Warning: deprecated language construct used in 'corr-lda.stan', line 26, column 18:
   -------------------------------------------------
    24:      for (n in (m+1):K) {
    25:        Sigma[m,n] <- sigma[m] * sigma[n] * Omega[m,n];
    26:        Sigma[n,m] <- Sigma[m,n];
                           ^
    27:      }
    28:    } 
   -------------------------------------------------

assignment operator <- is deprecated in the Stan language; use = instead.


Warning: deprecated language construct used in 'corr-lda.stan', line 44, column 16:
   -------------------------------------------------
    42:      real gamma[K];
    43:      for (k in 1:K) 
    44:        gamma[k] <- log(theta[doc[n],k]) + log(phi[k,w[n]]);
                         ^
    45:      increment_log_prob(log_sum_exp(gamma));  // likelihood
    46:    }
   -------------------------------------------------

assignment operator <- is deprecated in the Stan language; use = instead.


Warning: deprecated language construct used in 'corr-lda.stan', line 45, column 21:
   -------------------------------------------------
    43:      for (k in 1:K) 
    44:        gamma[k] <- log(theta[doc[n],k]) + log(phi[k,w[n]]);
    45:      increment_log_prob(log_sum_exp(gamma));  // likelihood
                              ^
    46:    }
    47:  }
   -------------------------------------------------

increment_log_prob(...); is deprecated and will be removed in the future. Use target += ...; instead.

  $ ../../../../../../../install/default/bin/stanc --auto-format lda.stan
data {
  int<lower=2> K;
  // num topics
  int<lower=2> V;
  // num words
  int<lower=1> M;
  // num docs
  int<lower=1> N;
  // total word instances
  int<lower=1, upper=V> w[N];
  // word n
  int<lower=1, upper=M> doc[N];
  // doc ID for word n
  vector<lower=0>[K] alpha;
  // topic prior
  vector<lower=0>[V] beta;
  // word prior
}
parameters {
  simplex[K] theta[M];
  // topic dist for doc m
  simplex[V] phi[K];
  // word dist for topic k
}
model {
  for (m in 1 : M) 
    theta[m] ~ dirichlet(alpha);
  // prior
  for (k in 1 : K) 
    phi[k] ~ dirichlet(beta);
  // prior
  for (n in 1 : N) {
    real gamma[K];
    for (k in 1 : K) 
      gamma[k] <- log(theta[doc[n], k]) + log(phi[k, w[n]]);
    increment_log_prob(log_sum_exp(gamma));
    // likelihood
  }
}


Warning: deprecated language construct used in 'lda.stan', line 23, column 16:
   -------------------------------------------------
    21:      real gamma[K];
    22:      for (k in 1:K) 
    23:        gamma[k] <- log(theta[doc[n],k]) + log(phi[k,w[n]]);
                         ^
    24:      increment_log_prob(log_sum_exp(gamma));  // likelihood
    25:    }
   -------------------------------------------------

assignment operator <- is deprecated in the Stan language; use = instead.


Warning: deprecated language construct used in 'lda.stan', line 24, column 21:
   -------------------------------------------------
    22:      for (k in 1:K) 
    23:        gamma[k] <- log(theta[doc[n],k]) + log(phi[k,w[n]]);
    24:      increment_log_prob(log_sum_exp(gamma));  // likelihood
                              ^
    25:    }
    26:  }
   -------------------------------------------------

increment_log_prob(...); is deprecated and will be removed in the future. Use target += ...; instead.

